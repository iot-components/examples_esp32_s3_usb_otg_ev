## USB 转串口 Demo

使用 ESP32-S2/S3 的 USB 和 UART 功能，制作可一个可用于调试和下载的 USB 转串口工具，功能如下：

1. USB - UART 双向透传
2. 可配置串口参数（波特率最大支持 3000000 bps）
3. 可支持 USB 转双串口
4. 实现 `esptool` 自动下载功能

```c
/*
 *                                │
 *                                │USB
 *                                │
 *                                ▼
 *                            ┌──────┐
 *                            │      │
 *                            │ O  O │
 *                            │      │
 *                        ┌───┴──────┴───┐
 *                        │              │
 * ┌───────────┐          │ ESP32-S3-OTG │
 * │           │          │              │
 * │           │ RX       │ ┌──┐         │
 * │           │◄─────────┼─┤  │expend IO│
 * │           │ TX       │ │  │         │
 * │Target_MCU │◄─────────┼─┤  │         │
 * │           │ IO0      │ │  │         │
 * │           │◄─────────┼─┤  │         │
 * │           │ EN       │ │  │         │
 * │           │◄─────────┼─┤  │         │
 * │           │          │ └──┘         │
 * └───────────┘          │              │
 *                        │              │
 *                        │              │
 *                        └───┬──────┬───┘
 *                            │ [  ] │
 *                            └──────┘
 */
```



### 默认引脚定义

ESP32-S3-OTG 开发板设计了可扩展 IO， 用户可以利用空闲引脚设计 DIY 功能，USB 转串口 Demo 利用了其中 4 个 IO，定义如下：

| 开发板 IO |     功能     |      备注      |
| :-------: | :----------: | :------------: |
|    46     |   UART-RX    | 连接目标板 TX  |
|    45     |   UART-TX    | 连接目标板 RX  |
|    26     | 自动下载-IO0 | 连接目标板 IO0 |
|     3     | 自动下载-EN  | 连接目标板 EN  |



## 自动下载功能

* 自动下载功能默认为关闭状态，可在 `menuconfig → USB UART Bridge Demo → Enable auto download`中打开该选项
* 使用自动下载功能时，请将开发板 `AUTODLD_EN_PIN` 和 `AUTODLD_IO0_PIN` 引脚分别连接到目标 MCU IO0（Boot）和 EN （RST）引脚
* 自动下载功能可能对某些开发板无效（RC 电路导致的时延问题），需要微调代码 `gpio_set_level` 软件延时